#!/bin/bash

#пацанчик ты походу не понял, в чей код ты лезешь. твоя манера лазанья тут меня не устраивает. 
#давай я обьясню тебе всё на понятном тебе языке. на python




case $USER in
	root)
		echo
	;;

	*)
		echo ошибка: недостаточно прав для запуска tvspkg
		exit 2
	;;

esac


exec 4>/dev/null
exec 2>/dev/null

echo tvspkg v1 by tvs_
echo
case $1 in

	-i)
		
		echo скачивание пакета...
		
		rm -r $2 >&4
		
		if git clone http://github.com/tvsclass/$2 >&4 ;
			
			then echo
			
			cd $2
			
			unzip -d ./.$2 ./$2.tvs
			
			cd ./.$2
			
			if find iscript.sh;
				then sh iscript.sh;
				
				else 
					echo iscript.sh не найден. автоматическая установка...
					if find bin;
						then
						
						echo копирование shell части...
						aaa=$(cat ./usr/bafl)
						cp -r bin /usr/
						chmod +x /usr/bin/$aaa;
					fi
					if find run.sh;
						then 
						echo запуск установщика...
						sh run.sh;
					fi
						
					echo инструкции выполнены.
				
				
				echo;
				#echo ошибка пакета. проверьте целостность пакета.;
			cd ..
			rm -r $2
			fi
			
			echo;
			
			else echo Возникла ошибка при обращении к git. проверьте соединение.
			exit 1;
			
		fi
		
		
	
	;;

	-l)
	
			unzip -d ./.$2 ./$2.tvs & echo '('
			
			cd ./.$2
			
			if find iscript.sh;
				then sh iscript.sh;
				
				else echo ошибка пакета. проверьте целостность пакета.;
			fi
			
			echo ;
	
	;;

	*)
		echo опция не найдена.
		echo
		echo опции:
		echo
		echo -l локальный пакет 
		echo -i интернет пакет
	;;


esac